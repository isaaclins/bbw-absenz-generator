<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absenzmeldung/Dispensationsgesuch</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
        }
        
        .form-container {
            width: 100%;
            border: 1px solid #fff;
            padding: 10px;
            background-color: #fff;
        }
        
        .form-row {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-row:after {
            content: "";
            display: block;
            border-bottom: 1px solid #000;
            margin-top: 5px;
        }
        
        .radio-group {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .radio-container {
            display: flex;
            align-items: center;
        }
        
        input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        
        .table-container {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .table-container th, .table-container td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        
        .signature-row {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        .signature-container {
            width: 45%;
        }
        
        .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 10px;
            height: 20px;
        }
        
        .dispensation-container {
            width: 45%;
        }
        
        .dispensation-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .dispensation-subtitle {
            margin-bottom: 20px;
        }
        
        .proposal-container {
            margin-top: 20px;
        }
        
        .proposal-title {
            margin-bottom: 10px;
        }
        
        .approval-container {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        
        .remarks-container {
            margin-bottom: 20px;
        }
        
        .remarks-label {
            margin-bottom: 5px;
        }
        
        .remarks-line {
            border-bottom: 1px solid #000;
            margin-bottom: 10px;
            height: 20px;
        }
        
        .final-decision-container {
            margin-top: 20px;
        }
        
        .final-decision-label {
            margin-bottom: 10px;
        }
        
        .final-approval {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .final-line {
            border-bottom: 1px solid #000;
            margin-top: 40px;
            margin-bottom: 10px;
            height: 20px;
        }
        
        .visum-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .visum-date {
            width: 40%;
        }
        
        .visum-signature {
            width: 55%;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            border: 1px solid black;
            padding: 8px;
        }
        
        .date-column {
            width: 20%;
        }
        
        .excuse-column, .no-excuse-column {
            width: 15%;
        }
        
        .teacher-column {
            width: 30%;
        }
        
        .attachment-column {
            width: 20%;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <!-- Name Row -->
        <div class="form-row">
            <div style="display: flex; justify-content: flex-start; align-items: center;">
                <div style="width: 150px;">Name, Vorname</div>
                <input type="text" style="flex: 1; border: none; outline: none;" placeholder="Name und Vorname eingeben">
            </div>
        </div>
        
        <!-- Absence Type Row with Class -->
        <div class="form-row">
            <div style="display: flex; justify-content: flex-start; align-items: center;">
                <div class="radio-group" style="margin-right: 80px;">
                    <div class="radio-container">
                        <input type="radio" name="absenceType" id="Absenzmeldung">
                        <div>Absenzmeldung</div>
                    </div>
                    <div class="radio-container">
                        <input type="radio" name="absenceType" id="dispensationsgesuch">
                        <div>Dispensationsgesuch</div>
                    </div>
                </div>
                <div style="width: 100px;">Klasse/Kurs</div>
                <input type="text" style="flex: 1; border: none; outline: none;" placeholder="Klasse oder Kurs eingeben">
            </div>
        </div>
        
        <!-- Absence Date Row -->
        <div class="form-row">
            <div style="display: flex; justify-content: flex-start; align-items: center;">
                <div style="width: 150px;">Datum der Abwesenheit</div>
                <input type="text" style="flex: 1; border: none; outline: none;" placeholder="Datum eingeben (z.B. 01.01.2025)">
            </div>
        </div>
        
        <!-- Absence Reason Row -->
        <div class="form-row">
            <div style="display: flex; justify-content: flex-start; align-items: center;">
                <div style="width: 150px;">Grund der Abwesenheit</div>
                <input type="text" style="flex: 1; border: none; outline: none;" placeholder="Grund der Abwesenheit eingeben">
            </div>
        </div>
        
        <!-- Beilagen Row -->
        <div style="margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>Beilagen</div>
                <div class="radio-container" style="margin-left: 30px;">
                    <input type="radio" name="beilagen" id="arztzeugnis">
                    <div>Arztzeugnis</div>
                </div>
                <div class="radio-container">
                    <input type="radio" name="beilagen" id="anderedokumente">
                    <div>Andere Dokumente</div>
                </div>
            </div>
        </div>
        
        <!-- Table Row -->
        
        <!-- Table Row -->
        <table>
            <thead>
                <tr>
                    <th>Lektionen</th>
                    <th>Von der Abwesenheit betroffene Lehrpersonen</th>
                    <th colspan="3">Visum der Lehrpersonen</th>
                </tr>
                <tr>
                    <th></th>
                    <th></th>
                    <th>Datum</th>
                    <th>entschuldigt</th>
                    <th>unentschuldigt</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
                <tr>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                    <td style="text-align: center;"><input type="checkbox"></td>
                </tr>
            </tbody>
        </table>
        
        <!-- Signature Section -->
        <div style="display: flex; justify-content: space-between; margin-top: 20px;">
            <!-- Left side: Signatures -->
            <div style="width: 48%;">
                <div style="margin-bottom: 40px;">
                    <div style="position: relative;">
                        <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        <div class="signature-line"></div>
                    </div>
                    <div>Unterschrift Lernende/Lernender</div>
                </div>
                
                <div style="margin-bottom: 40px;">
                    <div style="position: relative;">
                        <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        <div class="signature-line"></div>
                    </div>
                    <div>Datum, Unterschrift Inhaber/-in der elterlichen Sorge</div>
                </div>
                
                <div>
                    <div style="position: relative;">
                        <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        <div class="signature-line"></div>
                    </div>
                    <div>Datum, Unterschrift und Stempel des Lehrbetriebes</div>
                </div>
            </div>
            
            <!-- Right side: Dispensation -->
            <div style="width: 48%;">
                <div style="font-weight: bold;">Dispensationsgesuch</div>
                <div style="margin-bottom: 20px;">(14 Tage im Voraus einzureichen)</div>
                
                <div style="margin-bottom: 10px;">1. Vorschlag Klassenlehrperson</div>
                <div>bei einem Dispensationsgesauch</div>
                
                <div style="display: flex; gap: 20px; margin-top: 15px;">
                    <div class="radio-container">
                        <input type="radio" name="vorschlag" id="bewilligen">
                        <div>bewilligen</div>
                    </div>
                    <div class="radio-container">
                        <input type="radio" name="vorschlag" id="ablehnen">
                        <div>ablehnen</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <div>Bemerkungen</div>
                    <div style="position: relative;">
                        <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        <div class="signature-line"></div>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <div style="width: 40%;">
                        <div>Datum</div>
                        <div style="position: relative;">
                            <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        </div>
                    </div>
                    <div style="width: 55%;">
                        <div>Visum Klassenlehrperson</div>
                        <div style="position: relative;">
                            <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                        </div>
                    </div>
                </div>
                <div class="signature-line"></div>
                
                <div style="margin-top: 20px;">
                    <div style="display: flex; align-items: center;">
                        <div>2. Entscheid Abteilungsleitung</div>
                        <div style="display: flex; margin-left: 20px;">
                            <div class="radio-container" style="margin-right: 20px;">
                                <input type="radio" name="entscheid" id="bewilligt">
                                <div>bewilligt</div>
                            </div>
                            <div class="radio-container">
                                <input type="radio" name="entscheid" id="abgelehnt">
                                <div>abgelehnt</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="position: relative; margin-top: 30px;">
                    <input type="text" style="width: 100%; border: none; outline: none; position: absolute; bottom: 0; left: 0; background: transparent;">
                    <div class="signature-line"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 20px;">
        <button id="downloadBtn" style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
            Als PDF herunterladen
        </button>
    </div>

    <script>
        document.getElementById('downloadBtn').addEventListener('click', function() {
            // Zugriff auf jsPDF
            const { jsPDF } = window.jspdf;
            
            // Element auswählen, das als PDF gerendert werden soll
            const element = document.querySelector('.form-container');
            
            // Sicherstellen, dass alle input-Werte vor dem Rendern sichtbar sind
            document.querySelectorAll('input[type="text"]').forEach(input => {
                if (input.value) {
                    // Wir erstellen ein neues Element, um den Input-Wert zu zeigen
                    const valueSpan = document.createElement('span');
                    valueSpan.textContent = input.value;
                    valueSpan.style.position = 'absolute';
                    valueSpan.style.bottom = '0';
                    valueSpan.style.left = '0';
                    valueSpan.style.width = '100%';
                    
                    // Füge das Element neben dem Input ein
                    input.parentNode.appendChild(valueSpan);
                    
                    // Verstecke den Input temporär
                    input.style.opacity = '0';
                }
            });
            
            // Formular in Canvas umwandeln
            html2canvas(element, {
                scale: 2, // Für bessere Qualität
                logging: false,
                useCORS: true,
                allowTaint: true
            }).then(canvas => {
                // Canvas in PDF umwandeln
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });
                
                // Canvas auf PDF Seite einfügen mit Padding
                const imgProps = pdf.getImageProperties(imgData);
                const pdfWidth = pdf.internal.pageSize.getWidth();
                
                // Padding von 15mm auf allen Seiten
                const padding = 15;
                const contentWidth = pdfWidth - (padding * 2);
                const contentHeight = (imgProps.height * contentWidth) / imgProps.width;
                
                pdf.addImage(imgData, 'PNG', padding, padding, contentWidth, contentHeight);
                
                // PDF herunterladen
                pdf.save('Absenzmeldung_Dispensationsgesuch.pdf');
                
                // Entferne die temporären Span-Elemente und mache die Inputs wieder sichtbar
                document.querySelectorAll('input[type="text"]').forEach(input => {
                    // Entfernen des erzeugten Spans, falls vorhanden
                    const valueSpan = input.parentNode.querySelector('span');
                    if (valueSpan) {
                        valueSpan.remove();
                    }
                    
                    // Input wieder sichtbar machen
                    input.style.opacity = '1';
                });
            });
        });
    </script>
</body>
</html>
